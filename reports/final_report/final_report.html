<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yi Han, He Ma, Hancheng Qin">

<title>MDS Capstone Project Final Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="final_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="final_report_files/libs/quarto-html/quarto.js"></script>
<script src="final_report_files/libs/quarto-html/popper.min.js"></script>
<script src="final_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="final_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="final_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="final_report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="final_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="final_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="final_report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="custom.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#executive-summary" id="toc-executive-summary" class="nav-link active" data-scroll-target="#executive-summary"><span class="header-section-number">1</span> Executive summary</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2</span> Introduction</a></li>
  <li><a href="#data-science-methods" id="toc-data-science-methods" class="nav-link" data-scroll-target="#data-science-methods"><span class="header-section-number">3</span> Data science methods</a>
  <ul class="collapse">
  <li><a href="#model-development-pyholos" id="toc-model-development-pyholos" class="nav-link" data-scroll-target="#model-development-pyholos"><span class="header-section-number">3.1</span> Model development: PyHolos</a>
  <ul class="collapse">
  <li><a href="#model-reconstruction" id="toc-model-reconstruction" class="nav-link" data-scroll-target="#model-reconstruction"><span class="header-section-number">3.1.1</span> Model Reconstruction</a></li>
  <li><a href="#enhanced-flexibility" id="toc-enhanced-flexibility" class="nav-link" data-scroll-target="#enhanced-flexibility"><span class="header-section-number">3.1.2</span> Enhanced Flexibility</a></li>
  </ul></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="header-section-number">3.2</span> Analysis</a>
  <ul class="collapse">
  <li><a href="#validation-of-pyholos-outputs" id="toc-validation-of-pyholos-outputs" class="nav-link" data-scroll-target="#validation-of-pyholos-outputs"><span class="header-section-number">3.2.1</span> Validation of PyHolos Outputs</a></li>
  <li><a href="#sensitivity-analysis-using-pyholos" id="toc-sensitivity-analysis-using-pyholos" class="nav-link" data-scroll-target="#sensitivity-analysis-using-pyholos"><span class="header-section-number">3.2.2</span> Sensitivity Analysis Using PyHolos</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-product-and-results" id="toc-data-product-and-results" class="nav-link" data-scroll-target="#data-product-and-results"><span class="header-section-number">4</span> Data product and results</a>
  <ul class="collapse">
  <li><a href="#data-product---pyholos" id="toc-data-product---pyholos" class="nav-link" data-scroll-target="#data-product---pyholos"><span class="header-section-number">4.1</span> Data product - PyHolos</a>
  <ul class="collapse">
  <li><a href="#model-reconstruction-farmer-mode" id="toc-model-reconstruction-farmer-mode" class="nav-link" data-scroll-target="#model-reconstruction-farmer-mode"><span class="header-section-number">4.1.1</span> Model reconstruction: Farmer Mode</a></li>
  <li><a href="#enhanced-flexibility-scientific-mode" id="toc-enhanced-flexibility-scientific-mode" class="nav-link" data-scroll-target="#enhanced-flexibility-scientific-mode"><span class="header-section-number">4.1.2</span> Enhanced flexibility: Scientific Mode</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">4.2</span> Results</a>
  <ul class="collapse">
  <li><a href="#pyholos-model-validation" id="toc-pyholos-model-validation" class="nav-link" data-scroll-target="#pyholos-model-validation"><span class="header-section-number">4.2.1</span> PyHolos model validation</a></li>
  <li><a href="#sensitivity-analysis-results" id="toc-sensitivity-analysis-results" class="nav-link" data-scroll-target="#sensitivity-analysis-results"><span class="header-section-number">4.2.2</span> Sensitivity Analysis Results</a></li>
  </ul></li>
  <li><a href="#advantages-and-limitations" id="toc-advantages-and-limitations" class="nav-link" data-scroll-target="#advantages-and-limitations"><span class="header-section-number">4.3</span> Advantages and limitations</a></li>
  </ul></li>
  <li><a href="#conclusions-and-recommendations" id="toc-conclusions-and-recommendations" class="nav-link" data-scroll-target="#conclusions-and-recommendations"><span class="header-section-number">5</span> Conclusions and recommendations</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements"><span class="header-section-number">6</span> Acknowledgements</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">7</span> References</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix"><span class="header-section-number">8</span> Appendix</a>
  <ul class="collapse">
  <li><a href="#Parameters-N2O-Calculation" id="toc-Parameters-N2O-Calculation" class="nav-link" data-scroll-target="#Parameters-N2O-Calculation"><span class="header-section-number">8.1</span> Parameters for Crop Residue Nitrogen Calculation</a></li>
  <li><a href="#Equations-N2O-Calculation" id="toc-Equations-N2O-Calculation" class="nav-link" data-scroll-target="#Equations-N2O-Calculation"><span class="header-section-number">8.2</span> Equations for Crop Residue Nitrogen Calculation</a>
  <ul class="collapse">
  <li><a href="#total-crop-residues" id="toc-total-crop-residues" class="nav-link" data-scroll-target="#total-crop-residues"><span class="header-section-number">8.2.1</span> Total Crop Residues</a></li>
  <li><a href="#emission-factor" id="toc-emission-factor" class="nav-link" data-scroll-target="#emission-factor"><span class="header-section-number">8.2.2</span> Emission Factor</a></li>
  <li><a href="#emission" id="toc-emission" class="nav-link" data-scroll-target="#emission"><span class="header-section-number">8.2.3</span> Emission</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MDS Capstone Project Final Report</h1>
<p class="subtitle lead">Empowering Agriculture: Enhanced GHG Emissions Modeling</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yi Han, He Ma, Hancheng Qin </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="executive-summary" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Executive summary</h1>
<p>In collaboration with LiteFarm, we developed PyHolos, a Python-based model designed to enhance greenhouse gas emissions calculations, specifically for nitrous oxide. PyHolos can integrate into the existing LiteFarm framework. It further incorporates external data sources and allows for user-defined parameter ranges, offering improvements over the original Holos model. This tool not only provides farmers with emissions estimates for informed decision-making, but also assists researchers in uncertainty analysis for parameters and regions with significant data variability. Although robust, PyHolos has shown minor discrepancies in emission estimates compared to the original Holos software. To refine these calculations, we recommend ongoing communication with the Holos team for continuous improvement.</p>
</section>
<section id="introduction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction</h1>
<p>Climate change presents a major challenge for our planet, with agriculture significantly contributing to greenhouse gas (GHG) emissions through activities such as livestock farming, fertilizer application, and land management practices <span class="citation" data-cites="johnson2007agricultural">(<a href="#ref-johnson2007agricultural" role="doc-biblioref">Johnson et al. 2007</a>)</span>. Farmers are central to addressing this challenge, as their choices in crop selection and farming practices directly impact carbon emissions <span class="citation" data-cites="jantke2020agricultural">(<a href="#ref-jantke2020agricultural" role="doc-biblioref">Jantke et al. 2020</a>)</span>. Agricultural choices are influenced by immediate profits, long-term soil health, and the financial benefits of conservation and sustainability programs. Carbon credits, for example, offers farmers the opportunity to earn extra revenue by adopting practices that reduce carbon emissions <span class="citation" data-cites="barbato2023farmer">(<a href="#ref-barbato2023farmer" role="doc-biblioref">Barbato and Strong 2023</a>)</span>. However, farmers currently lack scientific support to balance losses from less profitable crops against potential gains from carbon credits.</p>
<p>Addressing the need for better decision-making support, the LiteFarm team is developing research-based innovative tools to help farmers balance financial and environmental benefits. The LiteFarm team consists of experts in research and development who are committed to providing tools that transform data into actionable insights for sustainability. They have developed an application that helps farmers manage their daily operations, boosting their income while also encouraging environmentally friendly practices. In the next phase, the team plans to enhance the app by integrating greenhouse gas (GHG) emissions calculations to further support sustainable farming decisions.</p>
<p>Selecting a suitable GHG emissions calculation model is crucial for this task. The Holos GHG emissions calculator was chosen model since it is open-source and has been endorsed by the Canadian government <span class="citation" data-cites="Holos2022">(<a href="#ref-Holos2022" role="doc-biblioref">Agriculture &amp; Agri-Food Canada 2022</a>)</span>. Holos is a dependable, cost-free alternative to commercial models. Nonetheless, this model has limitations: it operates as a standalone tool and cannot be directly integrated with the LiteFarm framework. Holos runs exclusively on Windows OS and is developed in C#, restricting its wider usability. Additionally, its fixed parameters limit the model’s flexibility and adaptability in incorporating data from new or alternative sources.</p>
<p>Our project aims to integrate the Holos GHG emission calculation module into the LiteFarm framework, focusing on nitrous oxide (<span class="math inline">\(N_2O\)</span>) emissions from crop residue. We enhance the existing Holos model to better align with our partner’s needs. Our objectives are:</p>
<ol type="1">
<li><p><strong>Model Reconstruction</strong>: We aim to rebuild the Holos model in Python for smoother integration with the LiteFarm application. This shift ensures better compatibility with the app’s existing framework and offers more accessibility than the original Holos software.</p></li>
<li><p><strong>Enhanced Flexibility</strong>: We aim to enhance the Holos model for parameter sampling from external data sources and user-defined distributions. This adjustment increases flexibility in model parameterization, adapting to diverse global agricultural environments. Including external data fits our partner’s global research scope and mitigates data scarcity in under-researched regions.</p></li>
<li><p><strong>Improving Reliability through Sensitivity Analysis</strong>: With the enhanced model, we conduct sensitivity analyses to understand how input variations affect GHG emission estimates. This process is vital for identifying and minimizing uncertainties, thereby helping researchers pinpoint research gaps and provide farmers with accurate, reliable data for informed decision-making.</p></li>
</ol>
</section>
<section id="data-science-methods" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data science methods</h1>
<section id="model-development-pyholos" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="model-development-pyholos"><span class="header-section-number">3.1</span> Model development: PyHolos</h2>
<p>We developed the PyHolos model to calculate nitrous oxide emissions from crop residues. After thoroughly reviewing the original Holos model code and technical reports, we identified equations with 23 parameters required for calculation (see details in Appendix <a href="#Parameters-N2O-Calculation">8.1</a> and <a href="#Equations-N2O-Calculation">8.2</a>).</p>
<section id="model-reconstruction" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="model-reconstruction"><span class="header-section-number">3.1.1</span> Model Reconstruction</h3>
<p>To replicate the original Holos outputs, we developed a Python-based version of the model, named PyHolos. This model consists of two key components: a Data Loader and a Calculator. During development, each component is divided into into smaller, manageable steps to improve the model’s structure and functionality. The Data Loader imports parameters by organizing them into specific categories, while the Calculator processes these values in sequential steps. This modular approach not only facilitates the storage of intermediate results but also enables validation of the calculation results against the original Holos outputs (<a href="#fig-structure-conceptual" class="quarto-xref">Figure&nbsp;1</a>). We utilized non-standard Python packages ‘requests’ for handling HTTP requests and ‘shapely’ for geometric operations for obtaining external soil and climate data <span class="citation" data-cites="shapely2024 requests2024">(<a href="#ref-shapely2024" role="doc-biblioref">Sean et al. 2024</a>; <a href="#ref-requests2024" role="doc-biblioref">Reitz 2024</a>)</span>.</p>
<div id="fig-structure-conceptual" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-structure-conceptual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="../../img/PyHolos-structure-conceptual.svg" type="image/svg+xml" style="width: 100%; height: auto;">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-structure-conceptual-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Figure</strong>&nbsp;1: PyHolos Model Architecture. This diagram outlines the PyHolos workflow where the Data Loader retrieves predefined Holos parameters from CSV files or pulls in external data as required by users. Parameters are systematically categorized into five groups: farm, crop, crop-group, climate and soil, and modifiers (see Appendix <a href="#Parameters-N2O-Calculation">8.1</a>). The Calculator component subsequently processes these parameters to perform calculations on crop residue, emission factors, and total <span class="math inline">\(N_2O\)</span> emissions.
</figcaption>
</figure>
</div>
</section>
<section id="enhanced-flexibility" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="enhanced-flexibility"><span class="header-section-number">3.1.2</span> Enhanced Flexibility</h3>
<p>While PyHolos uses Holos’s original fixed parameters for standard operations, we also enhanced its flexibility. We have added modules that retrieve external data, supporting advanced analytical methods such as bootstrapping and sampling (<a href="#fig-structure-conceptual" class="quarto-xref">Figure&nbsp;1</a>).</p>
<p>For climate parameters, we use API calls to access the National Aeronautics and Space Administration/Prediction of World Wide Energy Resources (NASA/POWER; http://power.larc.nasa.gov), and for soil data, we use the Harmonized World Soil Database <span class="citation" data-cites="nachtergaele2023harmonized">(<a href="#ref-nachtergaele2023harmonized" role="doc-biblioref">Nachtergaele et al. 2023</a>)</span>. These enhancements offer global coverage and refined data resolution, boosting the model’s accuracy and relevance.</p>
<p>Additionally, we have introduced customizable modules for setting crop and modifier parameters. This flexibility allows users with domain knowledge to tailor these parameters to their research needs.</p>
</section>
</section>
<section id="analysis" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="analysis"><span class="header-section-number">3.2</span> Analysis</h2>
<section id="validation-of-pyholos-outputs" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="validation-of-pyholos-outputs"><span class="header-section-number">3.2.1</span> Validation of PyHolos Outputs</h3>
<p>To validate PyHolos’ accuracy, we compared its outputs with those of the original Holos software, using identical input parameters across various crops and multiple yield scenarios.</p>
</section>
<section id="sensitivity-analysis-using-pyholos" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="sensitivity-analysis-using-pyholos"><span class="header-section-number">3.2.2</span> Sensitivity Analysis Using PyHolos</h3>
<p>We conducted a sensitivity analysis using a hypothetical dataset of 105 farms, each growing three different crop types. For each crop at each farm, we generated 100 samples for each parameter to assess how different parameters affect the model’s <span class="math inline">\(N_2O\)</span> estimations.</p>
<p>Unlike the original Holos model, which uses average climate and soil parameters from broad regions known as ecodistricts, PyHolos samples point-specific data from each farm’s corresponding ecodistrict. This approach assesses uncertainties associated with the Holos model and provides a detailed view of how environmental factors affect calculation. For other fixed variables in Holos where domain knowledge is lacking, we varied parameters by ±25% using a uniform distribution.</p>
</section>
</section>
</section>
<section id="data-product-and-results" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data product and results</h1>
<section id="data-product---pyholos" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="data-product---pyholos"><span class="header-section-number">4.1</span> Data product - PyHolos</h2>
<p>The PyHolos model uses predefined parameters to replicate original Holos outputs and incorporates user-defined variables along with external climate and soil data for greater flexibility (<a href="#fig-structure-simplified" class="quarto-xref">Figure&nbsp;2</a>). It calculates direct <span class="math inline">\(N_2O\)</span> emissions from crop residue in two modes: Farmer Mode and Scientific Mode. The PyHolos program is operated via command line, allowing users to specify the desired mode—Farmer or Scientific—and configure simulations and other settings.</p>
<div id="fig-structure-simplified" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-structure-simplified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="../../img/PyHolos-structure-simplified.svg" type="image/svg+xml" style="width: 100%; height: auto;">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-structure-simplified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Figure</strong>&nbsp;2: PyHolos Model Structure Overview. This diagram illustrates how PyHolos handles data management and processing. The Data Loader (gray shaded area) imports Holos parameters from CSV files or retrieves external data. The Calculator (light-yellow shaded area) computes crop residue, emission factors, and total <span class="math inline">\(N_2O\)</span> emissions. The data loader manages farm, crop, crop-group, climate and soil, and modifiers across five modules (blue boxes), which also integrate external climate and soil data and user-defined parameter distributions (purple boxes). Green boxes represent modules with supporting classes and functions. Salmon-colored boxes represent modules/classes invoked by <code>main.py</code>. Supporting scripts for defining parameter distribution and batch processing are stored under <code>scripts/</code> on our GitHub repository (yellow boxes). Thick gray-blue arrows depict main data flows, black solid lines show module interactions, and black dashed lines indicate farm data usage across modules. Each box includes a hyperlink to its module, class, or script on GitHub. Refer to the <a href="https://github.com/yhan178/LiteFarm-MDS-Capstone/blob/main/img/PyHolos-structure-full.svg" target="_blank">complete diagram</a> for detailed class attributes and methods.
</figcaption>
</figure>
</div>
<section id="model-reconstruction-farmer-mode" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="model-reconstruction-farmer-mode"><span class="header-section-number">4.1.1</span> Model reconstruction: Farmer Mode</h3>
<p>Farmer Mode delivers a single, definitive output, ideal for users seeking straightforward estimates, such as actual farmer users. When utilizing default Holos parameters, this mode aims to replicates the original Holos results using identical inputs such as farm location, crop type, yield, and area. Additionally, Farmer Mode supports the incorporation of external data to override standard Holos parameters, offering enhanced flexibility. For example, LiteFarm researchers can input their own research data or apply more precise parameters values to refine the estimation. The results are formatted in JSON as a simple dictionary.</p>
</section>
<section id="enhanced-flexibility-scientific-mode" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="enhanced-flexibility-scientific-mode"><span class="header-section-number">4.1.2</span> Enhanced flexibility: Scientific Mode</h3>
<p>Scientific Mode runs simulations by sampling across parameter distributions, generating multiple outputs per parameter. This mode is suitable for users conducting in-depth analyses. Results are formatted in JSON as nested dictionaries to accommodate multiple simulation results per parameter.</p>
<p>A key application of this mode is predicting and understanding emissions extremes and trends. For instance, the integrated external climate data source captures real-time changes, enabling temporal analyses that track emissions trends over time.</p>
</section>
</section>
<section id="results" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="results"><span class="header-section-number">4.2</span> Results</h2>
<section id="pyholos-model-validation" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="pyholos-model-validation"><span class="header-section-number">4.2.1</span> PyHolos model validation</h3>
<p>We compared the calculation outputs of PyHolos and Holos for two crop types: potatoes (a root crop) and soybeans (an annual crop). These two crop types use different <span class="math inline">\(N_2O\)</span> calculation equations and parameter values (see details in Appendix <a href="#Parameters-N2O-Calculation">8.1</a> and <a href="#Equations-N2O-Calculation">8.2</a>). While Holos software provides some intermediate results for crop residue calculation, aiding in comparison, it lacks intermediate data on emission factor calculation, hindering identification of sources of discrepancies in this aspect of the calculation (see components in the “calculator” module in <a href="#fig-structure-simplified" class="quarto-xref">Figure&nbsp;2</a>).</p>
<p>For potatoes, PyHolos accurately replicates Holos’ results for above and below-ground carbon inputs (<a href="#tbl-comparison-potatoes" class="quarto-xref">Table&nbsp;1</a>). However, there are minor differences in nitrogen from crop residues (<a href="#tbl-comparison-potatoes" class="quarto-xref">Table&nbsp;1</a>). The discrepancies become larger in the final <span class="math inline">\(N_2O\)</span> emissions, calculated by multiplying the nitrogen from crop residues by the emission factor (<a href="#tbl-comparison-potatoes" class="quarto-xref">Table&nbsp;1</a>). The origins of these discrepancies are unclear. According to equation 2.5.6-9 in Holos model (also see Appendix <a href="#total-crop-residues">8.2.1 Total Crop Residues</a>), nitrogen from crop residues should equal the sum of above and below-ground inputs multiplied by farm area, as calculated by PyHolos. Yet, Holos results suggest undocumented adjustments in how farm area data is used in calculation. Furthermore, the enlarged discrepancies in final <span class="math inline">\(N_2O\)</span> emissions indicate differences in emission factor calculations. However, the absence of intermediate results from Holos in emission factor calculations hinders tracing the sources of these discrepancies.</p>
<div class="cell" data-execution_count="2">
<div id="tbl-comparison-potatoes" class="cell quarto-float anchored" data-execution_count="2">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comparison-potatoes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Results comparison between Holos and PyHolos for potatoes (a root crop) across different yields.
</figcaption>
<div aria-describedby="tbl-comparison-potatoes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Crop</th>
<th data-quarto-table-cell-role="th">Yield</th>
<th data-quarto-table-cell-role="th">Aboveground Carbon Input</th>
<th data-quarto-table-cell-role="th">Belowground Carbon Input</th>
<th data-quarto-table-cell-role="th">N2O-N From Crop Residues</th>
<th data-quarto-table-cell-role="th">N2O Direct CO2e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Holos Software</td>
<td>Potatoes</td>
<td>10000</td>
<td>365.32</td>
<td>15.28</td>
<td>0.90</td>
<td>521.08</td>
</tr>
<tr class="even">
<td>Holos Software</td>
<td>Potatoes</td>
<td>30000</td>
<td>1095.96</td>
<td>45.86</td>
<td>2.70</td>
<td>1293.98</td>
</tr>
<tr class="odd">
<td>Holos Software</td>
<td>Potatoes</td>
<td>50000</td>
<td>1826.60</td>
<td>76.43</td>
<td>4.50</td>
<td>2066.88</td>
</tr>
<tr class="even">
<td>PyHolos</td>
<td>Potatoes</td>
<td>10000</td>
<td>365.32</td>
<td>15.29</td>
<td>0.83</td>
<td>354.47</td>
</tr>
<tr class="odd">
<td>PyHolos</td>
<td>Potatoes</td>
<td>30000</td>
<td>1095.96</td>
<td>45.86</td>
<td>2.48</td>
<td>1063.40</td>
</tr>
<tr class="even">
<td>PyHolos</td>
<td>Potatoes</td>
<td>50000</td>
<td>1826.60</td>
<td>76.43</td>
<td>4.13</td>
<td>1772.34</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>Unlike potatoes, which exhibit consistent above- and below-ground input estimations between PyHolos and Holos, soybeans show discrepancies across all parameters: above- and below-ground inputs, nitrogen from crop residues, and final <span class="math inline">\(N_2O\)</span> emissions (<a href="#tbl-comparison-soybeans" class="quarto-xref">Table&nbsp;2</a>). Besides the previously noted discrepancies in farm area usage and emission factor calculations, the sources of other discrepancies remain elusive. The Holos technical report indicates a linear relationship between crop yield and <span class="math inline">\(N_2O\)</span> emissions, a pattern observed in root crops like potatoes (<a href="#tbl-comparison-potatoes" class="quarto-xref">Table&nbsp;1</a> and <a href="#fig-comparison-holos" class="quarto-xref">Figure&nbsp;3</a>). However, Holos’ outputs for soybeans do not demonstrate this linearity. This inconsistency may stem from ongoing updates and developments in the Holos software, which may not be fully documented.</p>
<div class="cell" data-execution_count="3">
<div id="tbl-comparison-soybeans" class="cell quarto-float anchored" data-execution_count="3">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comparison-soybeans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Results comparison between Holos and PyHolos for soybeans (an annual crop) across different yields.
</figcaption>
<div aria-describedby="tbl-comparison-soybeans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<table class="dataframe do-not-create-environment cell table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Crop</th>
<th data-quarto-table-cell-role="th">Yield</th>
<th data-quarto-table-cell-role="th">Aboveground Carbon Input</th>
<th data-quarto-table-cell-role="th">Belowground Carbon Input</th>
<th data-quarto-table-cell-role="th">N2O-N From Crop Residues</th>
<th data-quarto-table-cell-role="th">N2O Direct CO2e</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Holos Software</td>
<td>Soybeans</td>
<td>1000</td>
<td>912.77</td>
<td>283.75</td>
<td>0.47</td>
<td>336.12</td>
</tr>
<tr class="even">
<td>Holos Software</td>
<td>Soybeans</td>
<td>3000</td>
<td>1317.41</td>
<td>532.97</td>
<td>0.75</td>
<td>455.35</td>
</tr>
<tr class="odd">
<td>Holos Software</td>
<td>Soybeans</td>
<td>5000</td>
<td>1116.49</td>
<td>646.55</td>
<td>0.74</td>
<td>453.66</td>
</tr>
<tr class="even">
<td>PyHolos</td>
<td>Soybeans</td>
<td>1000</td>
<td>598.71</td>
<td>312.94</td>
<td>0.80</td>
<td>342.30</td>
</tr>
<tr class="odd">
<td>PyHolos</td>
<td>Soybeans</td>
<td>3000</td>
<td>1796.12</td>
<td>938.81</td>
<td>2.39</td>
<td>1026.90</td>
</tr>
<tr class="even">
<td>PyHolos</td>
<td>Soybeans</td>
<td>5000</td>
<td>2993.53</td>
<td>1564.68</td>
<td>3.99</td>
<td>1711.49</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="cell-fig-comparison-holos" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div id="fig-comparison-holos" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-comparison-holos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="final_report_files/figure-html/fig-comparison-holos-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-comparison-holos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Figure</strong>&nbsp;3: Comparison of <span class="math inline">\(N_2O\)</span> Emission Estimates between PyHolos and Holos Software for Potatos and Soybeans across Different Yields. Blue squares represent Holos Software’s estimates, and red triangles depict PyHolos’ estimates. Based on current calculation equations (see Appendix <a href="#Equations-N2O-Calculation">8.2</a>), emissions should linearly correlate with crop yields, as demonstrated by PyHolos. While this linear relationship is evident for potatoes with Holos Software, it does not appear for soybeans.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sensitivity-analysis-results" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="sensitivity-analysis-results"><span class="header-section-number">4.2.2</span> Sensitivity Analysis Results</h3>
<p>We have analyzed model outputs across various parameters for different crops and farms using PyHolos’ Scientific Mode. Here we focus on soybean <span class="math inline">\(N_2O\)</span> emission estimates at a specific farm, illustrating the sensitivity of emission estimates to parameter changes (<a href="#fig-sensitivity-analysis-sample-case" class="quarto-xref">Figure&nbsp;4</a>). Each boxplot represents the variability induced by a single parameter while keeping other parameters constant.</p>
<div id="cell-fig-sensitivity-analysis-sample-case" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div id="fig-sensitivity-analysis-sample-case" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sensitivity-analysis-sample-case-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="final_report_files/figure-html/fig-sensitivity-analysis-sample-case-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sensitivity-analysis-sample-case-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<strong>Figure</strong>&nbsp;4: <span class="math inline">\(N_2O\)</span> Direct Emissions (<span class="math inline">\(CO_{2}e\)</span>) across different input parameters. The blue dashed line indicates the baseline emission value under Farmer Mode. Parameters sampled using external data sources (i.e., P, PE, RF_TX) are separated by a vertical dashed line from those sampled over the default user-defined distributions (uniform distribution, +-25%; RF_AM, RF_NS, S_r, Moisture, R_p). Detailed parameter explanations can be found in <a href="#tbl-params" class="quarto-xref">Table&nbsp;3</a> in Appendix <a href="#Parameters-N2O-Calculation">8.1</a>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>For parameters using external data sources, we observed a significant deviation between the Farmer Mode’s definitive estimations (i.e., Farmer Mode reference) and the median value of all samples from the ecodistrict, as observed with precipitation (P) (<a href="#fig-sensitivity-analysis-sample-case" class="quarto-xref">Figure&nbsp;4</a>). Thus, using ecodistrict averages in original Holos’s method may fail to accurately represent the specific conditions of farms located at the distribution extremes. Our finding underscores the importance of considering local conditions when refining <span class="math inline">\(N_2O\)</span> emission estimates.</p>
<p>For user-defined parameters, the Farmer Mode reference aligns with the median values, as the sampling distributions are default to uniform distributions with ±25% uncertainty (<a href="#fig-sensitivity-analysis-sample-case" class="quarto-xref">Figure&nbsp;4</a>). Nonetheless, these results remain insightful. Different parameters not only vary in magnitude but are also utilized differently in the calculation process—some are used in exponential equations, others in linear equations. Therefore, even though all parameters are sampled uniformly, their impact on the final <span class="math inline">\(N_2O\)</span> estimation varies. This variability provides critical insights into how sensitive <span class="math inline">\(N_2O\)</span> emissions to parameter changes, aiding in identifying areas with large uncertainties and research gaps.</p>
</section>
</section>
<section id="advantages-and-limitations" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="advantages-and-limitations"><span class="header-section-number">4.3</span> Advantages and limitations</h2>
<p>PyHolos enhances the original Holos model by replicating its ability to provide definitive <span class="math inline">\(N_2O\)</span> emission estimations and integrating external data sources to refine these estimates and evaluate uncertainties. Specifically, Farmer Mode aims to replicate Holos’ results using its original parameters, fulfilling our partner’s primary need to assist farmers with carbon emission estimations. Additionally, integrating external data enables modifying Holos’ parameters, meeting our partner’s needs for refined calculations with their own research data. Furthermore, Scientific Mode supports in-depth analyses by sampling across parameter distributions. This functionality helps pinpoint and reduce uncertainties in estimations, thereby improving calculation accuracy and supporting farmers’ decision-making.</p>
<p>The command-line operation of PyHolos not only facilitates integration with the LifeFarm framework but also offers time efficiency compared to the manual input methods used in the Holos software. For example, in our sensitivity analysis, calculating <span class="math inline">\(N_2O\)</span> emission estimations for 105 farms, each with three crops across 100 runs, took 13 hours—primarily delayed by NASA POWER API calls. In contrast, using Holos software for the same task would require approximately 10.9 days, assuming continuous operation and with each record taking 30 seconds to complete.</p>
<p>Currently, PyHolos focuses solely on estimating <span class="math inline">\(N_2O\)</span> emissions from crop residue and has not yet integrated other greenhouse gas emissions components from the Holos model. Given that Holos is still undergoing development and updates, continued efforts are necessary to fully align PyHolos with our partners’ needs. PyHolos is thoroughly documented in both methodology and usage. Its modular design allows for the addition of new functions and modules as needed, setting the groundwork for continuous development.</p>
</section>
</section>
<section id="conclusions-and-recommendations" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusions and recommendations</h1>
<p>Our project with LiteFarm aimed to address the challenge of calculating greenhouse gas emissions to support sustainable farming practices. We developed PyHolos, a Python-based model that not only replicates but also improves upon the original Holos model, offering <span class="math inline">\(N_2O\)</span> emission estimates from crop residues and integration with the LiteFarm framework.</p>
<p>PyHolos fulfills our partner’s fundamental needs for emission estimations and introduces enhancements over the original Holos model. These improvements include the integration of external or user-specific data for greater calculation accuracy and the capacity to conduct uncertainty analyses. As a result, PyHolos provides a useful tool for both farmers and researchers aiming to mitigate the environmental impact of agriculture.</p>
<p>While PyHolos has proven effective in estimating <span class="math inline">\(N_2O\)</span> emissions, it currently does not encompass other types of greenhouse gas emissions, limiting its wider utility. Additionally, minor discrepancies exist between PyHolos and the Holos software, likely due to ongoing updates in Holos yet outdated documentation.</p>
<p>Future development efforts of PyHolos should focus on expanding the model’s capabilities to include other greenhouse gases and refining its integration with the LiteFarm application. By continuing to enhance data accuracy and model flexibility, PyHolos will further empower farmers and researchers to make data-driven decisions. We recommend maintaining collaboration with the Holos team to ensure that PyHolos aligns with requirements of the LiteFarm team in greenhouse gas emission calculation and sustainable agricultural practices.</p>
</section>
<section id="acknowledgements" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Acknowledgements</h1>
<div class="appendix">
<p>We sincerely thank our mentor, Dr.&nbsp;Simon Goring, for his invaluable guidance and support throughout this project. We also thank our partner, the LiteFarm team at UBC. Special thanks to Dr.&nbsp;Khanh Dao Duc and Professor Hannah Wittman for providing us with the opportunity to work on this project and for their support throughout this journey.</p>
</div>
</section>
<section id="references" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Holos2022" class="csl-entry" role="listitem">
Agriculture &amp; Agri-Food Canada. 2022. <span>“Holos.”</span> <a href="https://github.com/holos-aafc/Holos" class="uri">https://github.com/holos-aafc/Holos</a>; GitHub.
</div>
<div id="ref-barbato2023farmer" class="csl-entry" role="listitem">
Barbato, Clare T, and Aaron L Strong. 2023. <span>“Farmer Perspectives on Carbon Markets Incentivizing Agricultural Soil Carbon Sequestration.”</span> <em>Npj Climate Action</em> 2 (1): 26. <a href="https://doi.org/10.1038/s44168-023-00055-4">https://doi.org/10.1038/s44168-023-00055-4</a>.
</div>
<div id="ref-jantke2020agricultural" class="csl-entry" role="listitem">
Jantke, Kerstin, Martina J Hartmann, Livia Rasche, Benjamin Blanz, and Uwe A Schneider. 2020. <span>“Agricultural Greenhouse Gas Emissions: Knowledge and Positions of German Farmers.”</span> <em>Land</em> 9 (5): 130. <a href="https://doi.org/10.3390/land9050130">https://doi.org/10.3390/land9050130</a>.
</div>
<div id="ref-johnson2007agricultural" class="csl-entry" role="listitem">
Johnson, Jane M-F, Alan J Franzluebbers, Sharon Lachnicht Weyers, and Donald C Reicosky. 2007. <span>“Agricultural Opportunities to Mitigate Greenhouse Gas Emissions.”</span> <em>Environmental Pollution</em> 150 (1): 107–24. <a href="https://doi.org/10.1016/j.envpol.2007.06.030">https://doi.org/10.1016/j.envpol.2007.06.030</a>.
</div>
<div id="ref-nachtergaele2023harmonized" class="csl-entry" role="listitem">
Nachtergaele, Freddy, Harrij van Velthuizen, Luc Verelst, Dave Wiberg, Matieu Henry, Frederica Chiozza, Yusuf Yigini, et al. 2023. <span>“Harmonized World Soil Database Version 2.0.”</span> Food; Agriculture Organization of the United Nations. <a href="https://www.fao.org/soils-portal/data-hub/soil-maps-and-databases/harmonized-world-soil-database-v20/en/">https://www.fao.org/soils-portal/data-hub/soil-maps-and-databases/harmonized-world-soil-database-v20/en/</a>.
</div>
<div id="ref-requests2024" class="csl-entry" role="listitem">
Reitz, Kenneth. 2024. <span>“Requests: HTTP for Humans™.”</span> <a href="https://pypi.org/project/requests/">https://pypi.org/project/requests/</a>.
</div>
<div id="ref-shapely2024" class="csl-entry" role="listitem">
Sean, Gillies, van der Wel Casper, Van den Bossche Joris, Taves Mike W., Arnott Joshua, and Ward Brendan C. 2024. <span>“Shapely: Manipulation and Analysis of Geometric Objects in the Cartesian Plane.”</span> <a href="https://doi.org/10.5281/zenodo.5597138">https://doi.org/10.5281/zenodo.5597138</a>.
</div>
</div>
</section>
<section id="appendix" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Appendix</h1>
<div class="appendix">

</div>
<section id="Parameters-N2O-Calculation" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="Parameters-N2O-Calculation"><span class="header-section-number">8.1</span> Parameters for Crop Residue Nitrogen Calculation</h2>
<div id="tbl-params" class="striped quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-params-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Parameters used in Holos <span class="math inline">\(N_2O\)</span> emission calculation
</figcaption>
<div aria-describedby="tbl-params-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter groups</th>
<th>Parameters</th>
<th>Explanation</th>
<th>Data source</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Farm</td>
<td>Area</td>
<td>Numerical, total area of the farm (ha)</td>
<td>LiteFarm</td>
<td></td>
</tr>
<tr class="even">
<td>Farm</td>
<td>Yield</td>
<td>Numerical, the estimated yield (<span class="math inline">\(kg/ha\)</span>)</td>
<td>LiteFarm</td>
<td></td>
</tr>
<tr class="odd">
<td>Crop</td>
<td>Moisture</td>
<td>Moisture content of product (%)</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="even">
<td>Crop</td>
<td><span class="math inline">\(N_p\)</span></td>
<td>N concentration in the product (<span class="math inline">\(kg \ kg^{-1}\)</span>)</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="odd">
<td>Crop</td>
<td><span class="math inline">\(N_s\)</span></td>
<td>N concentration in the straw (<span class="math inline">\(kg \ kg^{-1}\)</span>)</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="even">
<td>Crop</td>
<td><span class="math inline">\(N_r\)</span></td>
<td>N concentration in the roots (<span class="math inline">\(kg \ kg^{-1}\)</span>)</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="odd">
<td>Crop</td>
<td><span class="math inline">\(N_e\)</span></td>
<td>N concentration in the extra root material (<span class="math inline">\(kg \ kg^{-1}\)</span>)</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="even">
<td>Crop</td>
<td><span class="math inline">\(R_s\)</span></td>
<td>Relative biomass allocation coefficient for straw</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="odd">
<td>Crop</td>
<td><span class="math inline">\(R_p\)</span></td>
<td>Relative biomass allocation coefficient for product</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="even">
<td>Crop</td>
<td><span class="math inline">\(R_r\)</span></td>
<td>Relative biomass allocation coefficient for roots</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="odd">
<td>Crop</td>
<td><span class="math inline">\(R_e\)</span></td>
<td>Relative biomass allocation coefficient for extra-root material</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="even">
<td>Crop group</td>
<td><span class="math inline">\(C_{concentration}\)</span></td>
<td>Carbon concentration of all plant parts (<span class="math inline">\(kg \ kg^{-1}\)</span>)</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="odd">
<td>Crop group</td>
<td><span class="math inline">\(S_p\)</span></td>
<td>Percentage of product yield returned to soil</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="even">
<td>Crop group</td>
<td><span class="math inline">\(S_s\)</span></td>
<td>Percentage of straw returned to soils</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="odd">
<td>Crop group</td>
<td><span class="math inline">\(S_r\)</span></td>
<td>Percentage of roots returned to soil</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="even">
<td>Climate &amp; soil</td>
<td><span class="math inline">\(P_i\)</span></td>
<td>Annual growing season precipitation (May – October), in ecodistrict “i” (mm)</td>
<td>Holos default/NASA POWER</td>
<td></td>
</tr>
<tr class="odd">
<td>Climate &amp; soil</td>
<td><span class="math inline">\(PE\)</span></td>
<td>Growing season potential evapotranspiration, by ecodistrict (May – October)</td>
<td>Holos default/NASA POWER</td>
<td></td>
</tr>
<tr class="even">
<td>Climate &amp; soil</td>
<td><span class="math inline">\(FR\_Topo_{i}\)</span></td>
<td>Fraction of land occupied by lower portions of landscape</td>
<td>Holos default</td>
<td></td>
</tr>
<tr class="odd">
<td>Modifiers / soil</td>
<td><span class="math inline">\(RF\_TX_{i}\)</span></td>
<td>Weighted modifier which provides a correction of the <span class="math inline">\(EF_Topo\)</span> in ecodistrict ‘‘i’’ based on the soil texture</td>
<td>Holos default/HWSD 2.0</td>
<td></td>
</tr>
<tr class="even">
<td>Modifiers</td>
<td><span class="math inline">\(RF\_CS\)</span></td>
<td>Reduction factor for Cropping System</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="odd">
<td>Modifiers</td>
<td><span class="math inline">\(RF\_NS\)</span></td>
<td>N source modifier RF_NS (SN = Synthetic Nitrogen; ON = Organic Nitrogen; CRN = Crop Residue Nitrogen)</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="even">
<td>Modifiers</td>
<td><span class="math inline">\(RF\_AM\)</span></td>
<td>Reduction factor based on application method, only applicable to calculations of EF specific for SN</td>
<td>Holos default/External information</td>
<td></td>
</tr>
<tr class="odd">
<td>Modifiers</td>
<td><span class="math inline">\(RF\_Till\)</span></td>
<td>Tillage modifier (Conservation or Conventional Tillage)</td>
<td>Holos default/External information</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="Equations-N2O-Calculation" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="Equations-N2O-Calculation"><span class="header-section-number">8.2</span> Equations for Crop Residue Nitrogen Calculation</h2>
<p>The equations outdined are sourced from the <a href="https://github.com/holos-aafc/Holos/raw/e33ea632053a7635589c245318bd3ad05939607b/AAFC_Technical_Report_Holos_V4.0_Algorithm_Document_REVIEWVERSION22Jan2024.docx">AAFC Technical Report: Holos V4.0 Algorithm Document REVIEW VERSION 22 Jan 2024</a>. The numbers in parentheses following each equation indicate the specific equation numbers in the Holos documentation. Each equation includes a reference link to the corresponding line in the Holos code on GitHub.</p>
<section id="total-crop-residues" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="total-crop-residues"><span class="header-section-number">8.2.1</span> Total Crop Residues</h3>
<p><span class="math display">\[
N_{crop\_residues} = (AboveGround_{residue\_N} + BelowGround_{residue\_N}) \times {area} \quad \text{(2.5.6-9)}
\]</span></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(N_{crop\_residues}\)</span>: N (nitrogen) inputs from crop residue returned to soil (<span class="math inline">\(kg \ N\)</span>)</li>
<li><span class="math inline">\(AboveGround_{residue\_N}\)</span>: Aboveground residue nitrogen (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(BelowGround_{residue\_N}\)</span>: Belowground residue nitrogen (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(area\)</span>: Area of crop (<span class="math inline">\(ha\)</span>)</li>
</ul>
<section id="aboveground-residue-nitrogen" class="level4" data-number="8.2.1.1">
<h4 data-number="8.2.1.1" class="anchored" data-anchor-id="aboveground-residue-nitrogen"><span class="header-section-number">8.2.1.1</span> AboveGround Residue Nitrogen</h4>
<p><span class="math display">\[
AboveGround_{residue\_N} = [{Grain_N} + {Straw_N}] \quad \text{(2.5.6-6)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L617">Holos GitHub - Equation 2.5.6-6</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(AboveGround_{residue\_N}\)</span>: Nitrogen in above-ground crop residues (<span class="math inline">\(kg \ N\)</span>)</li>
<li><span class="math inline">\({Grain_N}\)</span>: Nitrogen content of the grain returned to the soil (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\({Straw_N}\)</span>: Nitrogen content of the straw returned to the soil (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
</ul>
</section>
<section id="belowground-residue-nitrogen" class="level4" data-number="8.2.1.2">
<h4 data-number="8.2.1.2" class="anchored" data-anchor-id="belowground-residue-nitrogen"><span class="header-section-number">8.2.1.2</span> BelowGround Residue Nitrogen</h4>
<p>For annual plants:</p>
<p><span class="math display">\[
BelowGround_{{residue_N}} = [{Root_N} + {Exudate_N}] \quad \text{(2.5.6-7)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L679">Holos GitHub - Equation 2.5.6-7</a></p>
<p>For perennial plants:</p>
<p><span class="math display">\[
BelowGround_{residue_N} = [S_r \times {Root}_N] + {Exudate_N} \quad \text{(2.5.6-8)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L685">Holos GitHub - Equation 2.5.6-8</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(BelowGround_{residue\_N}\)</span>: Belowground residue nitrogen (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\({Root_N}\)</span>: Nitrogen content of the root returned to the soil (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\({Exudate_N}\)</span>: Nitrogen content of the exudates returned to the soil (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(S_r\)</span>: Root turnover fraction</li>
</ul>
</section>
<section id="grain_n" class="level4" data-number="8.2.1.3">
<h4 data-number="8.2.1.3" class="anchored" data-anchor-id="grain_n"><span class="header-section-number">8.2.1.3</span> Grain_N</h4>
<p><span class="math display">\[
{Grain}_N = \frac{C_{p\_to\_soil}}{0.45} \times N_p \quad \text{(2.5.6-2)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L561">Holos GitHub - Equation 2.5.6-2</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\({Grain}_N\)</span>: Nitrogen content of the grain returned to the soil (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(C_{p\_to\_soil}\)</span>: Carbon input from product (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(N_p\)</span>: N concentration in the product (<span class="math inline">\(kg \ kg^{-1}\)</span>) <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
</ul>
</section>
<section id="straw_n" class="level4" data-number="8.2.1.4">
<h4 data-number="8.2.1.4" class="anchored" data-anchor-id="straw_n"><span class="header-section-number">8.2.1.4</span> Straw_N</h4>
<p><span class="math display">\[
{Straw}_N = \frac{C_s}{0.45} \times N_s \quad \text{(2.5.6-3)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L575">GitHub - Equation 2.5.6-3</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\({Straw}_N\)</span>: Nitrogen content of the straw returned to the soil (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(C_s\)</span>: Carbon input from straw (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(N_s\)</span>: N concentration in the straw (<span class="math inline">\(kg \ kg^{-1}\)</span>) <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
</ul>
</section>
<section id="root_n" class="level4" data-number="8.2.1.5">
<h4 data-number="8.2.1.5" class="anchored" data-anchor-id="root_n"><span class="header-section-number">8.2.1.5</span> Root_N</h4>
<p><span class="math display">\[
{Root}_N = \frac{C_r}{0.45} \times N_r \quad \text{(2.5.6-4)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L589">GitHub - Equation 2.5.6-4</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\({Root}_N\)</span>: Nitrogen content of the root returned to the soil (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(C_r\)</span>: Carbon input from roots (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(N_r\)</span>: N concentration in the roots (<span class="math inline">\(kg \ kg^{-1}\)</span>) <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
</ul>
</section>
<section id="exudate_n" class="level4" data-number="8.2.1.6">
<h4 data-number="8.2.1.6" class="anchored" data-anchor-id="exudate_n"><span class="header-section-number">8.2.1.6</span> Exudate_N</h4>
<p><span class="math display">\[
{Exudate}_N = \frac{C_e}{0.45} \times N_e \quad \text{(2.5.6-5)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L603">GitHub - Equation 2.5.6-5</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(\text{Exudate}_N\)</span>: Nitrogen content of the exudates returned to the soil (<span class="math inline">\(kg \ N \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(C_e\)</span>: Carbon input from extra-root material (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(N_e\)</span>: N concentration in the extra root material (<span class="math inline">\(kg \ kg^{-1}\)</span>) <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
</ul>
</section>
<section id="c_p-above-and-belowground-residue-input" class="level4" data-number="8.2.1.7">
<h4 data-number="8.2.1.7" class="anchored" data-anchor-id="c_p-above-and-belowground-residue-input"><span class="header-section-number">8.2.1.7</span> C_p: Above and Belowground Residue Input</h4>
<p><span class="math display">\[
C_p = [(yield + yield \times \frac{S_p}{100}) \times (1 - \frac{{moisture \ content}}{100})] \times {Carbon \ concentration} \quad \text{(2.1.2-6)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Carbon/ICBMSoilCarbonCalculator.cs#L270">GitHub - Equation 2.1.2-6</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(C_p\)</span>: Plant C (carbon) in agricultural product (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(yield\)</span>: Crop yield (<span class="math inline">\({kg} \text{ wet weight } ha^{-1}\)</span>, default provided, user override)</li>
<li><span class="math inline">\(S_p\)</span>: Percentage of product yield returned to soil (user override)</li>
<li><span class="math inline">\(\text{moisture content}\)</span>: Moisture content (%) of crop product <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
<li><span class="math inline">\(\text{Carbon concentration}\)</span>: C concentration of all plant parts (<span class="math inline">\(kg \ kg^{-1}\)</span>)</li>
</ul>
</section>
<section id="c_p_to_soil-carbon-input-from-product" class="level4" data-number="8.2.1.8">
<h4 data-number="8.2.1.8" class="anchored" data-anchor-id="c_p_to_soil-carbon-input-from-product"><span class="header-section-number">8.2.1.8</span> C_p_to_soil: Carbon input from product</h4>
<p><span class="math display">\[
C_{{p\_to\_soil}} = C_p \times \frac{S_p}{100} \quad \text{(2.1.2-7)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Carbon/ICBMSoilCarbonCalculator.cs#L307">GitHub - Equation 2.1.2-7</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(C_{p\_to\_soil}\)</span>: Carbon input from product (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(C_p\)</span>: Plant C (carbon) in agricultural product (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(S_p\)</span>: Percentage of product yield returned to soil</li>
</ul>
</section>
<section id="c_s-carbon-input-from-straw" class="level4" data-number="8.2.1.9">
<h4 data-number="8.2.1.9" class="anchored" data-anchor-id="c_s-carbon-input-from-straw"><span class="header-section-number">8.2.1.9</span> C_s: Carbon Input from Straw</h4>
<p><span class="math display">\[
C_s = C_p \times \frac{R_s}{R_p} \times \frac{S_s}{100} \quad \text{(2.1.2-8)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Carbon/ICBMSoilCarbonCalculator.cs#L344">GitHub - Equation 2.1.2-8</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(C_s\)</span>: C (carbon) input from straw (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(C_p\)</span>: Plant C (carbon) in agricultural product (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(R_s\)</span>: Relative biomass allocation coefficient for straw <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
<li><span class="math inline">\(R_p\)</span>：Relative biomass allocation coefficient for product <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
<li><span class="math inline">\(S_s\)</span>: Percentage of straw returned to soil (user override)</li>
</ul>
</section>
<section id="c_r-carbon-input-from-root" class="level4" data-number="8.2.1.10">
<h4 data-number="8.2.1.10" class="anchored" data-anchor-id="c_r-carbon-input-from-root"><span class="header-section-number">8.2.1.10</span> C_r: Carbon input from Root</h4>
<p><span class="math display">\[
C_r = C_p \times \frac{R_r}{R_p} \times \frac{S_r}{100} \quad \text{(2.1.2-9)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Carbon/ICBMSoilCarbonCalculator.cs#L398">GitHub - Equation 2.1.2-9</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(C_r\)</span>: C (carbon) input from roots (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(C_p\)</span>: Plant C (carbon) in agricultural product (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(R_r\)</span>:Relative biomass allocation coefficient for roots <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
<li><span class="math inline">\(R_p\)</span>：Relative biomass allocation coefficient for product <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
<li><span class="math inline">\(S_r\)</span>: Percentage of roots returned to soil (user override)</li>
</ul>
</section>
<section id="c_e-carbon-input-from-exudate" class="level4" data-number="8.2.1.11">
<h4 data-number="8.2.1.11" class="anchored" data-anchor-id="c_e-carbon-input-from-exudate"><span class="header-section-number">8.2.1.11</span> C_e: Carbon Input from Exudate</h4>
<p><span class="math display">\[
C_e = C_p \times \frac{R_e}{R_p} \quad \text{(2.1.2-9)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/21c18d94c871eaa1eaa2ab1d475eca0f0e34b35b/H.Core/Calculators/Carbon/ICBMSoilCarbonCalculator.cs#L398">GitHub - Equation 2.1.2-9</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(C_e\)</span>: C (carbon) input from extra-root material (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(C_p\)</span>: Plant C (carbon) in agricultural product (<span class="math inline">\(kg \ ha^{-1}\)</span>)</li>
<li><span class="math inline">\(R_e\)</span>: Relative biomass allocation coefficient for extra-root material <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
<li><span class="math inline">\(R_p\)</span>: Relative biomass allocation coefficient for product <a href="https://github.com/holos-aafc/Holos/blob/main/H.Content/Resources/Table_7_Relative_Biomass_Information.csv">[Holos Table 7]</a></li>
</ul>
</section>
</section>
<section id="emission-factor" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="emission-factor"><span class="header-section-number">8.2.2</span> Emission Factor</h3>
<section id="calculate-base-emission-factor---ecodistrict-level-emission-factor" class="level4" data-number="8.2.2.1">
<h4 data-number="8.2.2.1" class="anchored" data-anchor-id="calculate-base-emission-factor---ecodistrict-level-emission-factor"><span class="header-section-number">8.2.2.1</span> Calculate Base Emission Factor - Ecodistrict-level Emission Factor</h4>
<p><span class="math display">\[
EF\_CT_{i,P&gt;PE} = \exp^{0.00558 \times P_{i} - 7.7} \quad \text{(2.5.1-1)}
\]</span></p>
<p><span class="math display">\[
EF\_CT_{i,P\leqslant PE} = \exp^{0.00558 \times PE_{i} - 7.7} \quad \text{(2.5.1-2)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L880">GitHub - Equation 2.5.1</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(EF\_CT_i\)</span>: Ecodistrict-level emission factor (<span class="math inline">\(kg \, N_2O\text{-}N \, (kg \, N)^{-1}\)</span>)</li>
<li><span class="math inline">\(P_i\)</span>: Annual growing season precipitation (May – October), in ecodistrict “i” (mm)</li>
<li><span class="math inline">\(PE\)</span>: Growing season potential evapotranspiration, by ecodistrict (May – October) (mm)</li>
</ul>
</section>
<section id="calculate-emission-factor-adjustment-due-to-position-in-landscapetopography" class="level4" data-number="8.2.2.2">
<h4 data-number="8.2.2.2" class="anchored" data-anchor-id="calculate-emission-factor-adjustment-due-to-position-in-landscapetopography"><span class="header-section-number">8.2.2.2</span> Calculate Emission Factor Adjustment Due to Position in Landscape/Topography</h4>
<p>For humid environments <span class="math inline">\(P/PE \ &gt; \ 1\)</span>:</p>
<p><span class="math inline">\(EF\_Topo_i = EF\_CT_{i, \ P \ &gt; \ PE} \quad \text{(2.5.2-1)}\)</span></p>
<p>For non-irrigated sites and dry environments <span class="math inline">\(P/PE \leqslant 1\)</span>:</p>
<p><span class="math inline">\(EF\_Topo_i = (EF\_CT_{i,P&lt;PE} \times FR\_Topo_i) + [EF\_CT_{i,\ P \ &gt; \ PE} \times (1 - FR\_Topo_i)] \quad \text{(2.5.2-2)}\)</span></p>
<p>For irrigated sites and <span class="math inline">\(P &lt; PE\)</span>:</p>
<p><span class="math inline">\(EF\_Topo_i = EF\_CT_{i,\ P\leqslant PE} \quad \text{(2.5.2-3)}\)</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L381">GitHub - Equation 2.5.2</a></p>
<p><strong>Notes:</strong></p>
<p>For non-irrigated sites and <span class="math inline">\(P/PE \leqslant 1\)</span>, the fraction of low-lying land and depressions is calculated with the actual PE (<span class="math inline">\(EF\_CT_{i,P\leqslant PE}\)</span>), and the remainder of the land with the standard EF (<span class="math inline">\(EF\_CT_{i,P&gt;PE}\)</span>).</p>
<p>For irrigated sites, the assumption is that the irrigation amount is equal to <span class="math inline">\(PE - P\)</span>, thus making <span class="math inline">\(P = PE\)</span>.</p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(EF\_Topo_i\)</span>: <span class="math inline">\(N_2O\)</span> emission factor adjusted due to position in landscape and moisture regime (<span class="math inline">\(kg \, N_2O\text{-}N\)</span>)</li>
<li><span class="math inline">\(FR\_Topo_i\)</span>: Fraction of land occupied by lower portions of the landscape</li>
</ul>
</section>
<section id="calculate-emission-factor-adjustment-due-to-soil-texture" class="level4" data-number="8.2.2.3">
<h4 data-number="8.2.2.3" class="anchored" data-anchor-id="calculate-emission-factor-adjustment-due-to-soil-texture"><span class="header-section-number">8.2.2.3</span> Calculate Emission Factor Adjustment Due to Soil Texture</h4>
<p><span class="math display">\[
EF\_Base_i = (EF\_Topo_i \times RF\_TX_i) \times \frac{1}{0.645} \quad \text{(2.5.3-2)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/Calculators/Nitrogen/N2OEmissionFactorCalculator.cs#L451">GitHub - Equation 2.5.3-2</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(RF\_TX_i\)</span>: Weighted modifier which provides a correction of the <span class="math inline">\(EF\_Topo\)</span> in ecodistrict “i” based on the soil texture.</li>
<li><span class="math inline">\(EF\_Base_i\)</span>: A function of the three factors that create a base ecodistrict-specific value that accounts for the climatic, topographic, and edaphic characteristics of the spatial unit for lands.</li>
<li><span class="math inline">\(\frac{1}{0.645}\)</span>: Fraction of growing season emissions of total annual emissions (Pelster et al.&nbsp;2022, in prep.).</li>
</ul>
</section>
<section id="calculate-emission-factor" class="level4" data-number="8.2.2.4">
<h4 data-number="8.2.2.4" class="anchored" data-anchor-id="calculate-emission-factor"><span class="header-section-number">8.2.2.4</span> Calculate Emission Factor</h4>
<p><span class="math display">\[
EF_{i,k,l,m,n} = EF\_{Base_i} \times RF\_{NS_k} \times RF\_{Till_l} \times RF\_{CS_m} \times RF\_{AM} \quad \text{(2.5.4-1)}
\]</span></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(RF\_{NS_k}\)</span>: Reduction factor for N source, <span class="math inline">\(RF\_NS_k\)</span> (SN = Synthetic Nitrogen; ON = Organic Nitrogen; CRN = Crop Residue Nitrogen). For CRN, the value is 0.84. <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/Providers/Soil/Table_13_Soil_N2O_Emission_Factors_Provider.cs#L43">[Holos Lookup Function]</a></li>
<li><span class="math inline">\(RF\_{Till_l}\)</span>: Reduction factor for tillage practice <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/Providers/Soil/Table_13_Soil_N2O_Emission_Factors_Provider.cs#L93">[Holos Lookup Function]</a></li>
<li><span class="math inline">\(RF\_{CS_m}\)</span>: Reduction factor for cropping system. For annual cropping system, the value is 1. For Perennial systems, the value is 0.19 <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/Providers/Soil/Table_13_Soil_N2O_Emission_Factors_Provider.cs#L75">[Holos Lookup Function]</a></li>
<li><span class="math inline">\(RF\_{AM}\)</span>: Reduction factor based on application method, only applicable to calculations of EF specific for SN. For other N source, the value is 1 <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/Providers/Soil/Table_13_Soil_N2O_Emission_Factors_Provider.cs#L189">[Holos Lookup Function]</a></li>
</ul>
</section>
</section>
<section id="emission" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="emission"><span class="header-section-number">8.2.3</span> Emission</h3>
<section id="calculate-direct-nitrous-oxide-from-inputs" class="level4" data-number="8.2.3.1">
<h4 data-number="8.2.3.1" class="anchored" data-anchor-id="calculate-direct-nitrous-oxide-from-inputs"><span class="header-section-number">8.2.3.1</span> Calculate Direct Nitrous Oxide from Inputs</h4>
<p><span class="math display">\[
N_2O - N_{CRNdirect(t,field,n)} = N_{CropResidues(t,field,n)} \times EF_{i,CRN,l,m,n} \quad \text{(2.6.5-2)}
\]</span></p>
<p><strong>Holos Code Reference</strong>: <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/Calculators/Carbon/CarbonCalculatorBase.Nitrogen.cs#L377">GitHub - Equation 2.6.5-2</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(N_2O - N_{CRNdirect(t,field,n)}\)</span>: Direct <span class="math inline">\(N_2O\)</span> emissions (<span class="math inline">\(kg \, N_2O\text{-}N \, ha^{-1}\)</span>) resulting from crop residues and N mineralization on field n in year t.</li>
<li><span class="math inline">\(N_{CropResidues(t,field,n)}\)</span>: Amount of crop residues on field n in year t.</li>
<li><span class="math inline">\(EF_{i,CRN,l,m,n}\)</span>: Emission factor for crop residue nitrogen specific to the conditions i, l, m, and n.</li>
</ul>
</section>
<section id="calculate-emission-for-each-field-crop-and-year" class="level4" data-number="8.2.3.2">
<h4 data-number="8.2.3.2" class="anchored" data-anchor-id="calculate-emission-for-each-field-crop-and-year"><span class="header-section-number">8.2.3.2</span> Calculate Emission for Each Field, Crop, and Year</h4>
<p><span class="math display">\[
N_2O - N_{direct} = N_2O - N_{SNdirect} + N_2O - N_{CRNdirect} + N_2O - N_{CRNmindirect} + N_2O - N_{ONdirect}
\]</span></p>
<p><strong>Notes:</strong></p>
<p>Currently, only Nitrogen Direct Emission from crop residues is calculated, as this only accounts for crop-related factors and not livestock, fertilizer, and manure.</p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(N_2O - N_{SNdirect}\)</span>: <span class="math inline">\(N_2O\)</span> emissions (<span class="math inline">\(kg \, N_2O\text{-}N \, kg^{-1} \, N \, ha^{-1}\)</span>) resulting from fertilizer application</li>
<li><span class="math inline">\(N_2O - N_{CRNdirect}\)</span>: <span class="math inline">\(N_2O\)</span> emissions (<span class="math inline">\(kg \, N_2O\text{-}N \, kg^{-1} \, N \, ha^{-1}\)</span>) resulting from crop residues and N mineralization</li>
<li><span class="math inline">\(N_2O - N_{CRNmindirect}\)</span>: <span class="math inline">\(N_2O\)</span> emissions (<span class="math inline">\(kg \, N_2O\text{-}N \, kg^{-1} \, N \, ha^{-1}\)</span>) resulting from N mineralization</li>
<li><span class="math inline">\(N_2O - N_{ONdirect}\)</span>: <span class="math inline">\(N_2O\)</span> emissions (<span class="math inline">\(kg \, N_2O\text{-}N \, kg^{-1} \, N \, ha^{-1}\)</span>) resulting from organic fertilizers</li>
</ul>
</section>
<section id="convert-n_2o-n-to-n_2o" class="level4" data-number="8.2.3.3">
<h4 data-number="8.2.3.3" class="anchored" data-anchor-id="convert-n_2o-n-to-n_2o"><span class="header-section-number">8.2.3.3</span> Convert <span class="math inline">\(N_2O\)</span>-N to <span class="math inline">\(N_2O\)</span></h4>
<p><span class="math display">\[
N_2O = N_2O - N \times \frac{44}{28}
\]</span></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(\frac{44}{28}\)</span>: Conversion factor from <span class="math inline">\(N_2O\)</span>-N to <span class="math inline">\(N_2O\)</span> based on molecular mass</li>
</ul>
</section>
<section id="calculate-co_2-equivalent-of-n_2o-emissions" class="level4" data-number="8.2.3.4">
<h4 data-number="8.2.3.4" class="anchored" data-anchor-id="calculate-co_2-equivalent-of-n_2o-emissions"><span class="header-section-number">8.2.3.4</span> Calculate <span class="math inline">\(CO_2\)</span> Equivalent of <span class="math inline">\(N_2O\)</span> Emissions</h4>
<p><span class="math display">\[
CO_2e = N_2O \times 273
\]</span></p>
<p><strong>Notes:</strong></p>
<p>Holos uses 273 as the Global Warming Potential value for <span class="math inline">\(N_2O\)</span>. <a href="https://github.com/holos-aafc/Holos/blob/6f24e78c7bd46ae35848906933475f077562cd0d/H.Core/CoreConstants.cs#L135">Holos Reference</a></p>
<p><strong>Variables</strong>:</p>
<ul>
<li><span class="math inline">\(273\)</span>: Global Warming Potential for <span class="math inline">\(N_2O\)</span> compared to <span class="math inline">\(CO_2\)</span></li>
</ul>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>